#:kivy 1.11.1

BoxLayout:
    orientation: 'vertical'
    canvas.before:
        Color:
            rgba: app.theme_colors.background
        Rectangle:
            pos: self.pos
            size: self.size
    
    Label:
        id: alert_bar
        text: 'STATUS: MONITORING'
        font_size: '20sp'
        size_hint_y: 0.1
        color: app.theme_colors.accent_green
        canvas.before:
            Color:
                rgba: app.theme_colors.background[0] * 1.8, app.theme_colors.background[1] * 1.8, app.theme_colors.background[2] * 1.8, 1
            Rectangle:
                pos: self.pos
                size: self.size

    BoxLayout:
        size_hint_y: None
        height: 40
        padding: [5, 5, 5, 5]
        Button:
            text: "Clear Follower List"
            on_press: app.clear_follower_list()

    ScrollView:
        canvas.before:
            Color:
                rgba: app.theme_colors.background
            Rectangle:
                pos: self.pos
                size: self.size
        BoxLayout:
            id: follower_list
            orientation: 'vertical'
            size_hint_y: None
            height: self.minimum_height

<DeviceListItem>:
    orientation: 'vertical'
    padding: [10, 10, 10, 10]
    spacing: 5
    size_hint_y: None
    height: 170

    device_mac: ''
    device_alias: ''
    locations_seen: ''
    last_seen: ''
    display_name: ''
    device_type: ''

    Label:
        color: app.theme_colors.text_primary
        text: "Device: " + root.display_name
        font_size: '16sp'
    Label:
        color: app.theme_colors.text_primary
        text: "Type: " + root.device_type
    Label:
        color: app.theme_colors.text_primary
        text: "Locations Seen: " + root.locations_seen
    Label:
        color: app.theme_colors.text_primary
        text: "Last Seen: " + root.last_seen
    Button:
        text: "Name this Device"
        size_hint_y: None
        height: 40
        on_press: root.show_alias_popup()

<AliasPopup>:
    size_hint: 0.8, 0.7
    auto_dismiss: False

    BoxLayout:
        orientation: 'vertical'
        padding: 20
        spacing: 15
        
        Label:
            text: "Name a Device"
            font_size: '24sp'
            size_hint_y: None
            height: 40
            bold: True
            
        BoxLayout:
            size_hint_y: None
            height: 30
            Label:
                text: "MAC Address:"
                size_hint_x: 0.4
                halign: 'left'
            Label:
                text: root.device_mac
                font_name: 'DroidSansMono'
                bold: True
                size_hint_x: 0.6
        
        TextInput:
            id: alias_input
            hint_text: 'Enter Alias (e.g., "Gray Honda Civic")'
            multiline: False
            size_hint_y: None
            height: 40

        TextInput:
            id: notes_input
            hint_text: 'Enter notes (optional)'

        BoxLayout:
            size_hint_y: None
            height: 50
            spacing: 10
            Button:
                text: "Save"
                on_press: root.save(alias_input.text, notes_input.text)
            Button:
                text: "Cancel"
                on_press: root.dismiss()
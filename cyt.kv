#:kivy 1.11.1

BoxLayout:
    orientation: 'vertical'
    
    Label:
        id: alert_bar
        text: 'STATUS: MONITORING'
        font_size: '20sp'
        size_hint_y: 0.1
        color: 0, 1, 0, 1
        canvas.before:
            Color:
                rgba: 0.1, 0.1, 0.1, 1
            Rectangle:
                pos: self.pos
                size: self.size

    ScrollView:
        BoxLayout:
            id: follower_list
            orientation: 'vertical'
            size_hint_y: None
            height: self.minimum_height

<DeviceListItem>:
    orientation: 'vertical'
    padding: [10, 10, 10, 10]
    spacing: 5
    size_hint_y: None
    height: 170

    device_mac: ''
    device_alias: ''
    locations_seen: ''
    last_seen: ''
    display_name: ''
    device_type: ''

    Label:
        text: "Device: " + root.display_name
        font_size: '16sp'
    Label:
        text: "Type: " + root.device_type
    Label:
        text: "Locations Seen: " + root.locations_seen
    Label:
        text: "Last Seen: " + root.last_seen
    Button:
        text: "Name this Device"
        size_hint_y: None
        height: 40
        on_press: root.show_alias_popup()

# --- CHANGED: This entire rule has been redesigned ---
<AliasPopup>:
    size_hint: 0.8, 0.7 # Made slightly taller
    auto_dismiss: False

    BoxLayout:
        orientation: 'vertical'
        padding: 20 # Increased padding
        spacing: 15 # Increased spacing
        
        Label:
            text: "üè∑Ô∏è  Name a Device" # Added title with icon
            font_size: '24sp'
            size_hint_y: None
            height: 40
            bold: True
            
        BoxLayout: # New layout for the MAC address
            size_hint_y: None
            height: 30
            Label:
                text: "MAC Address:"
                size_hint_x: 0.4
                halign: 'left'
            Label:
                text: root.device_mac
                font_name: 'DroidSansMono' # Monospace font for technical look
                bold: True
                size_hint_x: 0.6
        
        TextInput:
            id: alias_input
            hint_text: 'Enter Alias (e.g., "Gray Honda Civic")'
            multiline: False
            size_hint_y: None
            height: 40

        TextInput:
            id: notes_input
            hint_text: 'Enter notes (optional)'

        BoxLayout:
            size_hint_y: None
            height: 50
            spacing: 10
            Button:
                text: "Save"
                on_press: root.save(alias_input.text, notes_input.text)
            Button:
                text: "Cancel"
                on_press: root.dismiss()